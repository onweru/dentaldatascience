---
title: Visualization of categorical data in dental research
author: Sergio Uribe
date: '2018-03-03'
slug: visualization-of-categorical-data-in-dental-research
draft: true
categories:
  - visualization
tags:
  - ggplot2
  - categorical data
---

Categorical data is often found in dental research reports. From the clinical perspective, it's easier to deal and understand since many clinical decisions are categorical: does this surface has caries? have this patient active caries? should I give a treatment?

Usually, this data are presented in tables, but there are some visualizations helpful to discover some associations. 

For example, a survey research  investigate the perception of children and their mothers as regards orthodontic treatment need and satisfaction with dental aesthetics ([De Souza et al. 2016](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5107559/))

The association of perceived of treatment need and satisfaction with appearance between children and their mothers is show in Table 4 of the paper: 

![From De Souza et al. 2016](/img/categ-data-table.png)

The p value = 0 is a frequent mistake in dental research reports. A p value represent a probability, hence p never has a value of 0 (or 1). If such were the case, p would no longer be a probability, but would become c, a certainty.

Let's recreate the table: 

```{r}
table4 <- matrix(c(188, 29, 20, 51), ncol = 2, byrow = TRUE)
colnames(table4) <- c("yes","no") #mother
rownames(table4) <- c("yes", "no")#children
names(table4)[1] <- "Children"
names(table4)[2] <- "Mothers"
table4 <- as.table(table4)
table4
```
Ok. 

We can visualize this data with 
```{r}
mosaicplot(table4)
```
But a useful option is to add shade to to display a legend for the Pearson residual.
```{r}
mosaicplot(table4, shade = TRUE)
```


The interpretation of the colors are:  __blue__ means there are more observations in that cell than would be expected under the null model (independence). __Red__ means there are fewer observations than would have been expected.

Another option is to visualize with ggplot2, but first we have to [recreate](https://stackoverflow.com/questions/49091515/create-fake-data-to-recreate-a-contingency-table)

```{r}
x <-  c()
for(row in rownames(table4)) {
    for(col in colnames(table4)) {
        x = rbind(x, matrix(rep(c(row, col), table4[row,col]), ncol = 2, byrow = TRUE))
    }
}

df <- data.frame(as.table(table4))[rep(sequence(prod(dim(table4))), 
                                        c(table4)), c(1, 2)]

df
df <-  as.data.frame(x)
```
Now we add the names
```{r}
names(df)[1] <- "Children"
names(df)[2] <- "Mothers"
```

```{r}
table(df$Children, df$Mothers)
```
```{r}
mosaicplot(table(df$Children,df$Mothers), 
           shade = TRUE)
```


```{r}
library(tidyverse)
```

```{r}
df %>% 
  ggplot(aes(x = Mothers, y = Children)) + 
  geom_count()
```


