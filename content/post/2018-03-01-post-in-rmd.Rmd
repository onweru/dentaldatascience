---
title: Post in rmd
author: Sergio Uribe
date: '2018-03-01'
slug: post-in-rmd
categories:
  - rmd
tags:
  - rmd
---

# Exploratory data analysis of medical data

Here are some code to create boxplots with significance bars

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent dictum augue ut purus rhoncus egestas. Proin euismod pharetra dolor vel volutpat. Etiam ante turpis, semper vitae lacus quis, dictum pretium purus. Nam sed nulla volutpat, blandit est et, accumsan orci. Sed ac ultricies mi. Fusce commodo urna vitae posuere rhoncus. Nullam ut augue quis sem egestas iaculis sed non nisl. Vestibulum laoreet felis volutpat mollis feugiat. Nullam sed libero non urna accumsan accumsan at sed enim. Vestibulum lobortis ex turpis, in varius lectus dictum at. In eget molestie felis.

Sed lobortis pretium interdum. Cras varius eu nulla et placerat. Donec fermentum dolor ut turpis consequat, ut rutrum sem dictum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec ut risus orci. Integer feugiat commodo arcu, volutpat aliquam nulla placerat sit amet. Proin quis vulputate lectus, at efficitur leo. Praesent mollis et lorem ac iaculis. Donec lacinia sem in pellentesque blandit. In tellus sapien, molestie vel ipsum non, pellentesque mattis nunc. In id nisi a justo tincidunt facilisis. Maecenas maximus pulvinar posuere. Vivamus quis lorem libero. Nullam ullamcorper sem sit amet mi gravida congue eget vitae risus. Sed id malesuada ante, eget porttitor arcu. Donec at nunc metus.

Ut at bibendum nisl, id dapibus felis. In vitae tempor leo. Etiam et eros interdum, scelerisque elit non, consequat ipsum. Quisque dignissim venenatis sem, eu dictum lectus consectetur at. Integer bibendum nibh odio, quis gravida tortor ornare at. Praesent at urna sit amet lacus commodo pharetra varius id nisi. Vestibulum ipsum purus, gravida mollis diam et, luctus convallis nunc. Fusce ultrices sapien nec odio efficitur, eget eleifend ante euismod. Integer placerat elementum est ultricies mattis. Cras ac ipsum ac diam maximus iaculis sit amet id sapien. Nunc condimentum velit turpis, non posuere libero efficitur sed.

In vitae erat vulputate, ornare nisi nec, posuere lorem. Nullam quam urna, laoreet quis justo quis, finibus pulvinar orci. Sed rhoncus sed nulla in venenatis. Vestibulum malesuada orci non sagittis vestibulum. In mollis varius nunc, at iaculis mi dictum eget. Vivamus varius dapibus bibendum. Aliquam quis imperdiet dui. Nam et nibh ultricies, volutpat enim et, dignissim ex. Integer eu nisl a nisl porta rutrum et eu lectus.

Phasellus congue tincidunt erat, vel commodo tellus volutpat sit amet. Ut rutrum odio ex, eu porta mi volutpat id. Vestibulum nec orci finibus, varius augue vitae, tempus tortor. Cras molestie sapien nec luctus blandit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sit amet ligula leo. Duis pharetra dolor et ornare semper. Fusce in urna eget purus efficitur ultricies a a diam. Sed a mauris vulputate, tempus felis aliquam, consectetur velit. Sed eros ligula, maximus eget placerat lacinia, venenatis ac sapien. Nunc finibus, ante eget tincidunt ornare, libero ex ultricies augue, vitae hendrerit libero urna sed nisi. Ut hendrerit vitae tellus eu iaculis. Nunc pellentesque elit id mauris posuere sagittis. Quisque convallis, justo vel lobortis sodales, erat libero pellentesque sem, ac scelerisque erat velit et ante.


<!--more-->

```{r}
library(pubh)
library(tidyverse)
```
## Dataset
```{r}
data(Hodgkin)
```

## Exploring the raw dataset
```{r}
head(Hodgkin)
```
## Summary tables
```{r}
Hodgkin %>% 
  gather(key = "Cell", value = value, CD4:CD8) %>% 
  group_by(Group, Cell) %>% 
  summarise(Mean = mean(value)) %>% 
  spread(Cell, Mean)
```
## Visualizations

### Histogram

```{r}
Hodgkin %>% 
  mutate("CD4/CD8 ratio" = CD4 / CD8) %>% 
  ggplot(aes(x = `CD4/CD8 ratio`, fill = Group)) +
  geom_histogram(bins = 9, alpha = 0.5) + 
  theme_minimal() +
  scale_fill_grey() 
```

### Boxplot with summary table
```{r}
Hodgkin %>% 
  mutate("CD4/CD8 ratio" = CD4 / CD8) %>% 
  group_by(Group) %>% 
  summarise(N = n(), 
            "Min." = min(`CD4/CD8 ratio`), 
            "Max." = max(`CD4/CD8 ratio`), 
            Mean = mean(`CD4/CD8 ratio`), 
            Median = median(`CD4/CD8 ratio`), 
            SD = sd(`CD4/CD8 ratio`)) %>% 
  mutate_if(is.numeric, funs(round(., 2)))
```


```{r}
Hodgkin %>% 
  mutate("CD4/CD8 ratio" = CD4 / CD8) %>% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  theme_minimal()
```

### Boxplot with jitter
```{r, message=FALSE}
Hodgkin %>% 
  mutate("CD4/CD8 ratio" = CD4 / CD8) %>% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y",
               stackdir = "center", 
               alpha = 0.3) +
  theme_minimal() 
```

### Most complete
require library(ggsignif)
```{r}

library(ggsignif)
```

```{r, message=FALSE}
Hodgkin %>% 
  mutate("CD4/CD8 ratio" = CD4 / CD8) %>% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y",
               stackdir = "center", 
               alpha = 0.3) +
  geom_signif(comparisons = list(c("Non-Hodgkin", "Hodgkin")), 
              map_signif_level=TRUE) +
  theme_minimal() +
  labs(
    caption = "\n * p>0.05; ** p<0.01; *** p<0.001 "
  )
  
```
