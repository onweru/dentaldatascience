---
title: Post in rmd
author: Sergio Uribe
date: '2018-03-01'
slug: post-in-rmd
categories:
  - rmd
tags:
  - rmd
---



<div id="exploratory-data-analysis-of-medical-data" class="section level1">
<h1>Exploratory data analysis of medical data</h1>
<p>Here are some code to create boxplots with significance bars</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent dictum augue ut purus rhoncus egestas. Proin euismod pharetra dolor vel volutpat. Etiam ante turpis, semper vitae lacus quis, dictum pretium purus. Nam sed nulla volutpat, blandit est et, accumsan orci. Sed ac ultricies mi. Fusce commodo urna vitae posuere rhoncus. Nullam ut augue quis sem egestas iaculis sed non nisl. Vestibulum laoreet felis volutpat mollis feugiat. Nullam sed libero non urna accumsan accumsan at sed enim. Vestibulum lobortis ex turpis, in varius lectus dictum at. In eget molestie felis.</p>
<p>Sed lobortis pretium interdum. Cras varius eu nulla et placerat. Donec fermentum dolor ut turpis consequat, ut rutrum sem dictum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec ut risus orci. Integer feugiat commodo arcu, volutpat aliquam nulla placerat sit amet. Proin quis vulputate lectus, at efficitur leo. Praesent mollis et lorem ac iaculis. Donec lacinia sem in pellentesque blandit. In tellus sapien, molestie vel ipsum non, pellentesque mattis nunc. In id nisi a justo tincidunt facilisis. Maecenas maximus pulvinar posuere. Vivamus quis lorem libero. Nullam ullamcorper sem sit amet mi gravida congue eget vitae risus. Sed id malesuada ante, eget porttitor arcu. Donec at nunc metus.</p>
<p>Ut at bibendum nisl, id dapibus felis. In vitae tempor leo. Etiam et eros interdum, scelerisque elit non, consequat ipsum. Quisque dignissim venenatis sem, eu dictum lectus consectetur at. Integer bibendum nibh odio, quis gravida tortor ornare at. Praesent at urna sit amet lacus commodo pharetra varius id nisi. Vestibulum ipsum purus, gravida mollis diam et, luctus convallis nunc. Fusce ultrices sapien nec odio efficitur, eget eleifend ante euismod. Integer placerat elementum est ultricies mattis. Cras ac ipsum ac diam maximus iaculis sit amet id sapien. Nunc condimentum velit turpis, non posuere libero efficitur sed.</p>
<p>In vitae erat vulputate, ornare nisi nec, posuere lorem. Nullam quam urna, laoreet quis justo quis, finibus pulvinar orci. Sed rhoncus sed nulla in venenatis. Vestibulum malesuada orci non sagittis vestibulum. In mollis varius nunc, at iaculis mi dictum eget. Vivamus varius dapibus bibendum. Aliquam quis imperdiet dui. Nam et nibh ultricies, volutpat enim et, dignissim ex. Integer eu nisl a nisl porta rutrum et eu lectus.</p>
<p>Phasellus congue tincidunt erat, vel commodo tellus volutpat sit amet. Ut rutrum odio ex, eu porta mi volutpat id. Vestibulum nec orci finibus, varius augue vitae, tempus tortor. Cras molestie sapien nec luctus blandit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sit amet ligula leo. Duis pharetra dolor et ornare semper. Fusce in urna eget purus efficitur ultricies a a diam. Sed a mauris vulputate, tempus felis aliquam, consectetur velit. Sed eros ligula, maximus eget placerat lacinia, venenatis ac sapien. Nunc finibus, ante eget tincidunt ornare, libero ex ultricies augue, vitae hendrerit libero urna sed nisi. Ut hendrerit vitae tellus eu iaculis. Nunc pellentesque elit id mauris posuere sagittis. Quisque convallis, justo vel lobortis sodales, erat libero pellentesque sem, ac scelerisque erat velit et ante.</p>
<!--more-->
<pre class="r"><code>library(pubh)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: latticeExtra</code></pre>
<pre><code>## Loading required package: RColorBrewer</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.7.2     ✔ stringr 1.2.0
## ✔ readr   1.1.1     ✔ forcats 0.2.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter()  masks stats::filter()
## ✖ dplyr::lag()     masks stats::lag()
## ✖ ggplot2::layer() masks latticeExtra::layer()</code></pre>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<pre class="r"><code>data(Hodgkin)</code></pre>
</div>
<div id="exploring-the-raw-dataset" class="section level2">
<h2>Exploring the raw dataset</h2>
<pre class="r"><code>head(Hodgkin)</code></pre>
<pre><code>##    CD4  CD8   Group
## 1  396  836 Hodgkin
## 2  568  978 Hodgkin
## 3 1212 1678 Hodgkin
## 4  171  212 Hodgkin
## 5  554  670 Hodgkin
## 6 1104 1335 Hodgkin</code></pre>
</div>
<div id="summary-tables" class="section level2">
<h2>Summary tables</h2>
<pre class="r"><code>Hodgkin %&gt;% 
  gather(key = &quot;Cell&quot;, value = value, CD4:CD8) %&gt;% 
  group_by(Group, Cell) %&gt;% 
  summarise(Mean = mean(value)) %&gt;% 
  spread(Cell, Mean)</code></pre>
<pre><code>## # A tibble: 2 x 3
## # Groups:   Group [2]
##   Group         CD4   CD8
## * &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 Non-Hodgkin   522   260
## 2 Hodgkin       823   614</code></pre>
</div>
<div id="visualizations" class="section level2">
<h2>Visualizations</h2>
<div id="histogram" class="section level3">
<h3>Histogram</h3>
<pre class="r"><code>Hodgkin %&gt;% 
  mutate(&quot;CD4/CD8 ratio&quot; = CD4 / CD8) %&gt;% 
  ggplot(aes(x = `CD4/CD8 ratio`, fill = Group)) +
  geom_histogram(bins = 9, alpha = 0.5) + 
  theme_minimal() +
  scale_fill_grey() </code></pre>
<p><img src="/post/2018-03-01-post-in-rmd_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="boxplot-with-summary-table" class="section level3">
<h3>Boxplot with summary table</h3>
<pre class="r"><code>Hodgkin %&gt;% 
  mutate(&quot;CD4/CD8 ratio&quot; = CD4 / CD8) %&gt;% 
  group_by(Group) %&gt;% 
  summarise(N = n(), 
            &quot;Min.&quot; = min(`CD4/CD8 ratio`), 
            &quot;Max.&quot; = max(`CD4/CD8 ratio`), 
            Mean = mean(`CD4/CD8 ratio`), 
            Median = median(`CD4/CD8 ratio`), 
            SD = sd(`CD4/CD8 ratio`)) %&gt;% 
  mutate_if(is.numeric, funs(round(., 2)))</code></pre>
<pre><code>## # A tibble: 2 x 7
##   Group           N  Min.  Max.  Mean Median    SD
##   &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 Non-Hodgkin  20.0 1.10   3.49  2.12   2.15 0.730
## 2 Hodgkin      20.0 0.470  3.82  1.50   1.19 0.910</code></pre>
<pre class="r"><code>Hodgkin %&gt;% 
  mutate(&quot;CD4/CD8 ratio&quot; = CD4 / CD8) %&gt;% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  theme_minimal()</code></pre>
<p><img src="/post/2018-03-01-post-in-rmd_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="boxplot-with-jitter" class="section level3">
<h3>Boxplot with jitter</h3>
<pre class="r"><code>Hodgkin %&gt;% 
  mutate(&quot;CD4/CD8 ratio&quot; = CD4 / CD8) %&gt;% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = &quot;y&quot;,
               stackdir = &quot;center&quot;, 
               alpha = 0.3) +
  theme_minimal() </code></pre>
<p><img src="/post/2018-03-01-post-in-rmd_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="most-complete" class="section level3">
<h3>Most complete</h3>
<p>require library(ggsignif)</p>
<pre class="r"><code>library(ggsignif)</code></pre>
<pre class="r"><code>Hodgkin %&gt;% 
  mutate(&quot;CD4/CD8 ratio&quot; = CD4 / CD8) %&gt;% 
  ggplot(aes(x = Group, y = `CD4/CD8 ratio`)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = &quot;y&quot;,
               stackdir = &quot;center&quot;, 
               alpha = 0.3) +
  geom_signif(comparisons = list(c(&quot;Non-Hodgkin&quot;, &quot;Hodgkin&quot;)), 
              map_signif_level=TRUE) +
  theme_minimal() +
  labs(
    caption = &quot;\n * p&gt;0.05; ** p&lt;0.01; *** p&lt;0.001 &quot;
  )</code></pre>
<p><img src="/post/2018-03-01-post-in-rmd_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
</div>
